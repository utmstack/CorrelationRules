- id: 1016
  dataTypes:
    - rhel_family
  name: CVE Vulnerability Detection in RHEL System
  impact:
    confidentiality: 4
    integrity: 5
    availability: 3
  category: Vulnerability Management
  technique: Vulnerability Exploitation
  adversary: origin
  references:
    - https://access.redhat.com/security/vulnerabilities
    - https://attack.mitre.org/techniques/T1203/
  description: Detects when a CVE vulnerability is identified in RHEL system packages during security scans or update checks. This rule monitors for CVE identifiers in package management logs, security advisories, and system vulnerability assessments.
  where: |
    (safe(log.message, "") =~ "CVE-\\d{4}-\\d{4,}" ||
     safe(log.cve, "") != "" ||
     safe(log.vulnerability, "") != "" ||
     (safe(log.program, "") in ["yum", "dnf", "rpm"] && safe(log.message, "") =~ "vulnerability|CVE")) &&
    safe(log.severity, "") in ["critical", "important", "high", "moderate"]
  afterEvents:
    - indexPattern: v11-log-*
      with:
        - field: host.name.keyword
          operator: filter_term
          value: '{{host.name}}'
      within: now-24h
      count: 3
  deduplicateBy:
    - host.name
    - log.cve