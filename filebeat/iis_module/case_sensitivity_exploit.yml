- id: 1021
  dataTypes:
    - iis-log
  name: IIS Case Sensitivity Exploitation Attempt
  description: Detects attempts to exploit case sensitivity vulnerabilities in IIS by looking for unusual URL patterns with mixed case variations that could bypass security filters or access controls
  where: |
    (target.path.matches("(?i).*[A-Z]+.*[a-z]+.*") || target.path.matches("(?i).*[a-z]+.*[A-Z]+.*")) &&
    (target.path.matches("(?i).*(cmd|powershell|script|exec|system|shell|admin|config|web\\.config|global\\.asa).*") ||
     target.path.matches("(?i).*\\.(asp|aspx|ashx|asmx|axd|config|asa).*")) &&
    (statusCode >= 200 && statusCode < 300) &&
    !target.path.matches("(?i).*\\.(css|js|jpg|jpeg|png|gif|ico|woff|woff2|ttf|eot)$")
  confidentiality: high
  integrity: medium
  availability: low
  mitreAttack:
    - T1190 # Exploit Public-Facing Application
    - T1055 # Process Injection
    - T1027 # Obfuscated Files or Information