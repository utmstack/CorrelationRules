- id: 1025
  dataTypes:
    - iis-log
  name: IIS WebDAV LOCK Method Exploitation Attempt
  description: Detects LOCK method attempts that could indicate WebDAV exploitation attempts, including denial of service or unauthorized file locking
  where: |
    log.method == "LOCK" &&
    (statusCode == 200 || statusCode == 201 || statusCode == 423 || statusCode == 401 || statusCode == 405) &&
    (target.path.matches("(?i).*\\.(asp|aspx|config|txt|xml|doc|docx|xls|xlsx|pdf).*") ||
     target.path.matches("(?i).*/web\\.config.*") ||
     target.path.matches("(?i).*/global\\.asa.*") ||
     log.userAgent.matches("(?i).*(scanner|exploit|metasploit|nikto|nessus).*") ||
     log.userAgent == "" ||
     log.userAgent == "-")
  confidentiality: medium
  integrity: high
  availability: high
  mitreAttack:
    - T1499 # Endpoint Denial of Service
    - T1498 # Network Denial of Service
    - T1565 # Data Manipulation