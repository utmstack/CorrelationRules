- id: 1005
  dataTypes:
  - hids
  name: Critical Vulnerability Detected by HIDS
  impact:
    confidentiality: 3
    integrity: 3
    availability: 3
  category: Vulnerability Management
  technique: Exploit Public-Facing Application
  adversary: origin
  references:
  - https://attack.mitre.org/techniques/T1190/
  - https://www.ossec.net/docs/manual/vulnerability-detection/
  description: Detects critical vulnerabilities identified by HIDS vulnerability assessment
    module, indicating systems at high risk of exploitation
  where: "safe(log.module, \"\") == \"vulnerability_detector\" ||\nsafe(log.eventType,\
    \ \"\") == \"vulnerability_found\" ||\n(safe(log.message, \"\") contains \"vulnerability\
    \ detected\" || \n safe(log.message, \"\") contains \"CVE-\" ||\n safe(log.message,\
    \ \"\") contains \"vulnerable package\") ||\n(safe(log.severity, \"\") == \"critical\"\
    \ || \n safe(log.severity, \"\") == \"high\") ||\nsafe(log.cvss_score, 0) >= 7.0\n"
  afterEvents:
  - indexPattern: v11-log-hids-*
    with:
    - field: origin.ip.keyword
      operator: filter_term
      value: '{{origin.ip}}'
    within: now-12h
    count: 1
  deduplicateBy:
  - origin.ip
  - log.cve_id
  - log.package_name
