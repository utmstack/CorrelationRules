- id: 1009
  dataTypes:
    - antivirus-esmc-eset
  name: ESET Exploit Detection Alert
  impact:
    confidentiality: 5
    integrity: 5
    availability: 3
  category: Exploit Detection
  technique: Exploitation for Privilege Escalation
  adversary: origin
  references:
    - https://www.eset.com/us/about/technology/
    - https://attack.mitre.org/techniques/T1068/
  description: Detects when ESET's Exploit Blocker identifies and blocks exploitation attempts targeting vulnerabilities in commonly exploited applications such as browsers, document readers, email clients, Flash, and Java.
  where: safe(log.event_type, "") == "Exploit_Event" && safe(action, "") == "blocked" && safe(severity, "") in ["medium", "high"]
  afterEvents:
    - indexPattern: v11-log-*
      with:
        - field: target.host.keyword
          operator: filter_term
          value: '{{target.host}}'
      within: now-2h
      count: 2
  deduplicateBy:
    - target.host
    - log.hash