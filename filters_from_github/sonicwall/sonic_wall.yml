# SonicWall Firewall, version 3.0.1
# Based on docs
# Support Syslog CEF format
#
# Documentations
# 1- https://www.sonicwall.com/techdocs/pdf/sonicos-6-5-4-log-events-reference-guide.pdf
# 2- https://docs.elastic.co/integrations/sonicwall_firewall
# 3- https://www.ossec.net/docs/log_samples/firewalls/sonicwall.html
#
# Implementation
# 1. Parsing the RAW field containing the PfSense
# 2. Parsing headers of syslog the message 

pipeline:
  - dataTypes:
      - firewall-sonicwall
    steps:
      #......................................................................#
      #......................................................................#
      # Using grok to parse syslogHeader of the message
      #......................................................................#
      - grok:
          patterns:
            - fieldName: log.priority
              pattern: '\<{{.data}}\>'
            - fieldName: log.syslogVersion
              pattern: '{{.integer}}'
            - fieldName: log.deviceTime
              pattern: '{{.year}}-{{.monthNumber}}-{{.monthDay}}{{.space}}{{.time}}'
            - fieldName: log.syslogHost
              pattern: '{{.hostname}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}\='
            - fieldName: log.id
              pattern: '{{.integer}}'
            - fieldName: log.msgAll
              pattern: '{{.greedy}}'
          source: raw

      # ......................................................................#
      # Checking if the log is in CEF format
      #......................................................................#
      # Using grok to parse syslogHeader of the message
      # ......................................................................#
      - grok:
          patterns:
            - fieldName: log.priority
              pattern: '\<{{.data}}\>'
            - fieldName: log.syslogVersion
              pattern: '{{.integer}}'
            - fieldName: log.deviceTime
              pattern: '{{.year}}-{{.monthNumber}}-{{.monthDay}}{{.space}}{{.time}}'
            - fieldName: log.syslogHost
              pattern: '{{.hostname}}'
            - fieldName: log.formatType
              pattern: '(CEF:)'
            - fieldName: log.formatVersion
              pattern: '(\s)?{{.integer}}'
            - fieldName: log.cefMsgAll
              pattern: '{{.greedy}}'
          source: raw
          where: raw.contains("CEF:")       

      #......................................................................#
      # Removing unnecessary characters of the syslogHeader
      #......................................................................#
      - trim:
          function: prefix
          substring: "<"
          fields:
            - log.priority
      - trim:
          function: suffix
          substring: ">"
          fields:
            - log.priority
      - trim:
          function: suffix
          substring: ":"
          fields:
            - log.formatType

      #......................................................................#
      # Using grok to parse CEF fields
      #......................................................................#
      - grok:
          patterns:
            - fieldName: log.dvcVendor
              pattern: '\|{{.data}}\|'
            - fieldName: log.dvcProduct
              pattern: '{{.data}}\|'
            - fieldName: log.dvcVersion
              pattern: '{{.data}}\|'
            - fieldName: log.eventId
              pattern: '{{.data}}\|'
            - fieldName: log.eventName
              pattern: '{{.data}}\|'
            - fieldName: log.severity
              pattern: '{{.data}}\|'
            - fieldName: log.msgAll
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - trim:
          function: prefix
          substring: "|"
          fields:
            - log.dvcVendor
  
      - trim:
          function: suffix
          substring: "|"
          fields:
            - log.dvcVendor
            - log.dvcProduct
            - log.dvcVersion
            - log.eventId
            - log.eventName
            - log.severity

      #......................................................................#
      # Using grok to parse common msg_all field components in syslog format and CEF format
      #......................................................................#
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(app=)'
            - fieldName: log.app
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(appcat=)'
            - fieldName: log.appcat
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll
      
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(appid=)'
            - fieldName: log.appid
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(arg=)'
            - fieldName: log.arg
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(bcastRx=)'
            - fieldName: log.bcastRx
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(bcastTx=)'
            - fieldName: log.bcastTx
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(bid=)'
            - fieldName: log.bid
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(bytesRx=)'
            - fieldName: log.bytesRx
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(bytesTx=)'
            - fieldName: log.bytesTx
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(category=)'
            - fieldName: log.category
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dpi=)'
            - fieldName: log.dpi
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dst=)'
            - fieldName: log.dst
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dstname=)'
            - fieldName: log.dstname
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(gcat=)'
            - fieldName: log.gcat
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(goodRxBytes=)'
            - fieldName: log.goodRxBytes
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(goodTxBytes=)'
            - fieldName: log.goodTxBytes
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(if=)'
            - fieldName: log.if
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(ipscat=)'
            - fieldName: log.ipscat
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(ipspri=)'
            - fieldName: log.ipspri
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(msg=)'
            - fieldName: log.msg
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(mgmtip=)'
            - fieldName: log.mgmtip
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(proto=)'
            - fieldName: log.proto
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(radio=)'
            - fieldName: log.radio
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(referer=)'
            - fieldName: log.referer
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(sid=)'
            - fieldName: log.sid
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(spycat=)'
            - fieldName: log.spycat
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(spypri=)'
            - fieldName: log.spypri
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(src=)'
            - fieldName: log.src
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(station=)'
            - fieldName: log.station
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(ucastRx=)'
            - fieldName: log.ucastRx
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(ucastTx=)'
            - fieldName: log.ucastTx
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      #......................................................................#
      # Using grok to remove unnecessary data
      #......................................................................#
      - grok:
          patterns:
            - fieldName: log.app
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.app

      - grok:
          patterns:
            - fieldName: log.appcat
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.appcat

      - grok:
          patterns:
            - fieldName: log.appid
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.appid

      - grok:
          patterns:
            - fieldName: log.arg
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.arg

      - grok:
          patterns:
            - fieldName: log.bcastRx
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.bcastRx

      - grok:
          patterns:
            - fieldName: log.bcastTx
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.bcastTx

      - grok:
          patterns:
            - fieldName: log.bid
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.bid

      - grok:
          patterns:
            - fieldName: log.bytesRx
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.bytesRx

      - grok:
          patterns:
            - fieldName: log.bytesTx
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.bytesTx

      - grok:
          patterns:
            - fieldName: log.category
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.category

      - grok:
          patterns:
            - fieldName: log.dpi
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dpi

      - grok:
          patterns:
            - fieldName: log.dst
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dst

      - grok:
          patterns:
            - fieldName: log.dstname
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dstname

      - grok:
          patterns:
            - fieldName: log.gcat
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.gcat

      - grok:
          patterns:
            - fieldName: log.goodRxBytes
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.goodRxBytes

      - grok:
          patterns:
            - fieldName: log.goodTxBytes
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.goodTxBytes

      - grok:
          patterns:
            - fieldName: log.if
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.if

      - grok:
          patterns:
            - fieldName: log.ipscat
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.ipscat

      - grok:
          patterns:
            - fieldName: log.ipspri
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.ipspri

      - grok:
          patterns:
            - fieldName: log.msg
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.msg

      - grok:
          patterns:
            - fieldName: log.mgmtip
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.mgmtip

      - grok:
          patterns:
            - fieldName: log.proto
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.proto

      - grok:
          patterns:
            - fieldName: log.radio
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.radio

      - grok:
          patterns:
            - fieldName: log.referer
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.referer

      - grok:
          patterns:
            - fieldName: log.sid
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.sid

      - grok:
          patterns:
            - fieldName: log.spycat
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.spycat

      - grok:
          patterns:
            - fieldName: log.spypri
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.spypri

      - grok:
          patterns:
            - fieldName: log.src
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.src

      - grok:
          patterns:
            - fieldName: log.station
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.station

      - grok:
          patterns:
            - fieldName: log.ucastRx
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.ucastRx

      - grok:
          patterns:
            - fieldName: log.ucastTx
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.ucastTx

      #......................................................................#
      # Using grok to parse msg_all components from syslog format only
      #......................................................................#
      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(af_polid=)'
            - fieldName: log.af_polid
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(af_policy=)'
            - fieldName: log.af_policy
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(af_type=)'
            - fieldName: log.af_type
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(af_service=)'
            - fieldName: log.af_service
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(af_action=)'
            - fieldName: log.af_action
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(af_object=)'
            - fieldName: log.af_object
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(ai=)'
            - fieldName: log.ai
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(appName=)'
            - fieldName: log.appName
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(c=)'
            - fieldName: log.c
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(catid=)'
            - fieldName: log.catid
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(cdur=)'
            - fieldName: log.cdur
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(change=)'
            - fieldName: log.change
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(code=)'
            - fieldName: log.code
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(conns=)'
            - fieldName: log.conns
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(contentObject=)'
            - fieldName: log.contentObject
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(icmpCode=)'
            - fieldName: log.icmpCode
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dstMac=)'
            - fieldName: log.dstMac
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dstV6=)'
            - fieldName: log.dstV6
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dstZone=)'
            - fieldName: log.dstZone
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dur=)'
            - fieldName: log.dur
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(dyn=)'
            - fieldName: log.dyn
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(f=)'
            - fieldName: log.f
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(fileid=)'
            - fieldName: log.fileid
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(filetxstatus=)'
            - fieldName: log.filetxstatus
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(fw=)'
            - fieldName: log.fw
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(fw_action=)'
            - fieldName: log.fw_action
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(fwlan=)'
            - fieldName: log.fwlan
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(i=)'
            - fieldName: log.i
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(lic=)'
            - fieldName: log.lic
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(m=)'
            - fieldName: log.m
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(mailFrom=)'
            - fieldName: log.mailFrom
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(n=)'
            - fieldName: log.n
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(natDst=)'
            - fieldName: log.natDst
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(natDstV6=)'
            - fieldName: log.natDstV6
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(natSrc=)'
            - fieldName: log.natSrc
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(natSrcV6=)'
            - fieldName: log.natSrcV6
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(note=)'
            - fieldName: log.note
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(npcs=)'
            - fieldName: log.npcs
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(op=)'
            - fieldName: log.op
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(packetdatId=)'
            - fieldName: log.packetdatId
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(packetdatNum=)'
            - fieldName: log.packetdatNum
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(packetdatEnc=)'
            - fieldName: log.packetdatEnc
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(pri=)'
            - fieldName: log.pri
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(pt=)'
            - fieldName: log.pt
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(rcptTo=)'
            - fieldName: log.rcptTo
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(rcvd=)'
            - fieldName: log.rcvd
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(result=)'
            - fieldName: log.result
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(rpkt=)'
            - fieldName: log.rpkt
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(rule=)'
            - fieldName: log.rule
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(sent=)'
            - fieldName: log.sent
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(sess=)'
            - fieldName: log.sess
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(sn=)'
            - fieldName: log.sn
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(spkt=)'
            - fieldName: log.spkt
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(srcMac=)'
            - fieldName: log.srcMac
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(srcZone=)'
            - fieldName: log.srcZone
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(time=)'
            - fieldName: log.time
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(type=)'
            - fieldName: log.type
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(unsynched=)'
            - fieldName: log.unsynched
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(usestandbysa=)'
            - fieldName: log.usestandbysa
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(user=)'
            - fieldName: log.user
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(vpnpolicy=)'
            - fieldName: log.vpnpolicy
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll

      - grok:
          patterns:
            - fieldName: log.irrelevant
              pattern: '{{.data}}(vpnpolicyDst=)'
            - fieldName: log.vpnpolicyDst
              pattern: '{{.data}}({{.word}}=)'
            - fieldName: log.irrelevant
              pattern: '{{.greedy}}'
          source: log.cefMsgAll
      
      #......................................................................#
      # Using grok to remove unnecessary data
      #......................................................................#
      - grok:
          patterns:
            - fieldName: log.afpolid
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.afpolid

      - grok:
          patterns:
            - fieldName: log.afpolicy
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.afpolicy

      - grok:
          patterns:
            - fieldName: log.aftype
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.aftype

      - grok:
          patterns:
            - fieldName: log.afservice
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.afservice

      - grok:
          patterns:
            - fieldName: log.afaction
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.afaction

      - grok:
          patterns:
            - fieldName: log.afobject
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.afobject

      - grok:
          patterns:
            - fieldName: log.ai
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.ai

      - grok:
          patterns:
            - fieldName: log.appName
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.appName

      - grok:
          patterns:
            - fieldName: log.c
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.c

      - grok:
          patterns:
            - fieldName: log.catid
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.catid

      - grok:
          patterns:
            - fieldName: log.cdur
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.cdur

      - grok:
          patterns:
            - fieldName: log.change
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.change

      - grok:
          patterns:
            - fieldName: log.code
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.code

      - grok:
          patterns:
            - fieldName: log.conns
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.conns

      - grok:
          patterns:
            - fieldName: log.contentObject
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.contentObject

      - grok:
          patterns:
            - fieldName: log.icmpCode
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.icmpCode

      - grok:
          patterns:
            - fieldName: log.dstMac
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dstMac

      - grok:
          patterns:
            - fieldName: log.dstV6
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dstV6

      - grok:
          patterns:
            - fieldName: log.dstZone
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dstZone

      - grok:
          patterns:
            - fieldName: log.dur
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dur

      - grok:
          patterns:
            - fieldName: log.dyn
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.dyn

      - grok:
          patterns:
            - fieldName: log.f
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.f

      - grok:
          patterns:
            - fieldName: log.fileid
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.fileid

      - grok:
          patterns:
            - fieldName: log.filetxstatus
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.filetxstatus

      - grok:
          patterns:
            - fieldName: log.fw
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.fw

      - grok:
          patterns:
            - fieldName: log.fwaction
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.fwaction

      - grok:
          patterns:
            - fieldName: log.fwlan
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.fwlan

      - grok:
          patterns:
            - fieldName: log.i
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.i

      - grok:
          patterns:
            - fieldName: log.lic
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.lic

      - grok:
          patterns:
            - fieldName: log.m
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.m

      - grok:
          patterns:
            - fieldName: log.mailFrom
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.mailFrom

      - grok:
          patterns:
            - fieldName: log.n
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.n

      - grok:
          patterns:
            - fieldName: log.natDst
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.natDst

      - grok:
          patterns:
            - fieldName: log.natDstV6
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.natDstV6

      - grok:
          patterns:
            - fieldName: log.natSrc
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.natSrc

      - grok:
          patterns:
            - fieldName: log.natSrcV6
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.natSrcV6

      - grok:
          patterns:
            - fieldName: log.note
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.note

      - grok:
          patterns:
            - fieldName: log.npcs
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.npcs

      - grok:
          patterns:
            - fieldName: log.op
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.op

      - grok:
          patterns:
            - fieldName: log.packetdatId
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.packetdatId

      - grok:
          patterns:
            - fieldName: log.packetdatNum
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.packetdatNum

      - grok:
          patterns:
            - fieldName: log.packetdatEnc
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.packetdatEnc

      - grok:
          patterns:
            - fieldName: log.pri
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.pri

      - grok:
          patterns:
            - fieldName: log.pt
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.pt

      - grok:
          patterns:
            - fieldName: log.rcptTo
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.rcptTo

      - grok:
          patterns:
            - fieldName: log.rcvd
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.rcvd

      - grok:
          patterns:
            - fieldName: log.result
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.result

      - grok:
          patterns:
            - fieldName: log.rpkt
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.rpkt

      - grok:
          patterns:
            - fieldName: log.rule
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.rule

      - grok:
          patterns:
            - fieldName: log.sent
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.sent

      - grok:
          patterns:
            - fieldName: log.sess
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.sess

      - grok:
          patterns:
            - fieldName: log.sn
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.sn

      - grok:
          patterns:
            - fieldName: log.spkt
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.spkt

      - grok:
          patterns:
            - fieldName: log.srcMac
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.srcMac

      - grok:
          patterns:
            - fieldName: log.srcZone
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.srcZone

      - grok:
          patterns:
            - fieldName: log.time
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.time

      - grok:
          patterns:
            - fieldName: log.type
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.type

      - grok:
          patterns:
            - fieldName: log.unsynched
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.unsynched

      - grok:
          patterns:
            - fieldName: log.usestandbysa
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.usestandbysa

      - grok:
          patterns:
            - fieldName: log.user
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.user

      - grok:
          patterns:
            - fieldName: log.vpnpolicy
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.vpnpolicy

      - grok:
          patterns:
            - fieldName: log.vpnpolicyDst
              pattern: '{{.greedy}}{{.space}}'
            - fieldName: log.irrelevant
              pattern: '{{.word}}(=)'
          source: log.vpnpolicyDst

      # ................................................#
      # Rename fields
      # ................................................#
      - rename:
          from:
            - log.dst
          to: target.ip
      - rename:
          from:
            - log.dstname
          to: target.host
      - rename:
          from:
            - log.proto
          to: protocol
      - rename:
          from:
            - log.src
          to: origin.ip
      - rename:
          from:
            - log.src
          to: origin.ip
      - rename:
          from:
            - log.afaction
          to: action
      - rename:
          from:
            - log.dstMac
          to: target.mac
      - rename:
          from:
            - log.srcMac
          to: origin.mac
      - rename:
          from:
            - log.dmac
          to: target.mac
      - rename:
          from:
            - log.smac
          to: origin.mac
      - rename:
          from:
            - log.susr
          to: origin.user

      # Adding geolocation to origin.ip
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: origin.ip
            destination: origin.geolocation
          where: exists("origin.ip")
      
      # Adding geolocation to target.ip
      - dynamic:
          plugin: com.utmstack.geolocation
          params:
            source: target.ip
            destination: target.geolocation
          where: exists("target.ip")

      # ..........................................................................#
      # Removing unnuse fields
      #.........................................................................#
      - delete:
          fields:
            - log.irrelevant
            - log.msgAll
            - log.cefMsgAll